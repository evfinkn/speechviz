<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: CustomSegmentMarker.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: CustomSegmentMarker.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { Line } from 'konva/lib/shapes/Line';
import { Rect } from 'konva/lib/shapes/Rect';
import { Text } from 'konva/lib/shapes/Text';

/**
 * Custom marker that appears when hovering over segments. Same as default marker except the drag handle is higher.
 * Code is practically exactly the code for the default segment marker in Peaks, with 1 or 2 lines changed to make
 * the handle higher.
 */
const CustomSegmentMarker = class CustomSegmentMarker {
  constructor(options) {
    this._options = options;
  }

  init(group) {
    var handleWidth = 10;
    var handleHeight = 20;
    var handleX = -(handleWidth / 2) + 0.5; // Place in the middle of the marker

    var xPosition = this._options.startMarker ? -24 : 24;

    var time = this._options.startMarker ? this._options.segment.startTime :
      this._options.segment.endTime;

    // Label - create with default y, the real value is set in fitToView().
    this._label = new Text({
      x: xPosition,
      y: 0,
      text: this._options.layer.formatTime(time),
      fontFamily: this._options.fontFamily,
      fontSize: this._options.fontSize,
      fontStyle: this._options.fontStyle,
      fill: '#000',
      textAlign: 'center'
    });

    this._label.hide();

    // Handle - create with default y, the real value is set in fitToView().
    this._handle = new Rect({
      x: handleX,
      y: 0,
      width: handleWidth,
      height: handleHeight,
      fill: this._options.color,
      stroke: this._options.color,
      strokeWidth: 1
    });

    // Vertical Line - create with default y and points, the real values
    // are set in fitToView().
    this._line = new Line({
      x: 0,
      y: 0,
      stroke: this._options.color,
      strokeWidth: 1
    });

    group.add(this._label);
    group.add(this._line);
    group.add(this._handle);

    this.fitToView();

    this.bindEventHandlers(group);
  }

  bindEventHandlers(group) {
    var self = this;

    var xPosition = self._options.startMarker ? -24 : 24;

    if (self._options.draggable) {
      group.on('dragstart', function () {
        if (self._options.startMarker) {
          self._label.setX(xPosition - self._label.getWidth());
        }

        self._label.show();
      });

      group.on('dragend', function () {
        self._label.hide();
      });
    }

    self._handle.on('mouseover touchstart', function () {
      if (self._options.startMarker) {
        self._label.setX(xPosition - self._label.getWidth());
      }

      self._label.show();
    });

    self._handle.on('mouseout touchend', function () {
      self._label.hide();
    });
  }

  fitToView() {
    var height = this._options.layer.getHeight();

    this._label.y(height / 6 - 5);
    this._handle.y(height / 6 - 10.5);
    this._line.points([0.5, 0, 0.5, height]);
  }

  timeUpdated(time) {
    this._label.setText(this._options.layer.formatTime(time));
  }
}

/** Method used by Peaks to create a CustomSegmentMarker */
const createSegmentMarker = function (options) {
  return new CustomSegmentMarker(options)
}

export default createSegmentMarker;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="CustomSegmentMarker.html">CustomSegmentMarker</a></li><li><a href="Group.html">Group</a></li><li><a href="Groups.html">Groups</a></li><li><a href="Segment.html">Segment</a></li><li><a href="TreeItem.html">TreeItem</a></li></ul><h3>Global</h3><ul><li><a href="global.html#arrayMean">arrayMean</a></li><li><a href="global.html#arraySum">arraySum</a></li><li><a href="global.html#compareProperty">compareProperty</a></li><li><a href="global.html#createSegmentMarker">createSegmentMarker</a></li><li><a href="global.html#getRandomColor">getRandomColor</a></li><li><a href="global.html#globals">globals</a></li><li><a href="global.html#htmlToElement">htmlToElement</a></li><li><a href="global.html#objectMap">objectMap</a></li><li><a href="global.html#propertiesEqual">propertiesEqual</a></li><li><a href="global.html#sortByProp">sortByProp</a></li><li><a href="global.html#toggleButton">toggleButton</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.11</a> on Sun Sep 18 2022 14:10:34 GMT-0500 (Central Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
